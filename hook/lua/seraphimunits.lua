---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by maudlin27.
--- DateTime: 04/08/2024 09:55
---
local M28Events = import('/mods/M28AI/lua/AI/M28Events.lua')
--Needed for LOUD as for some reason callbacks dont trigger for Seraphim (e.g. when building a shield); although expected to be fixed in LOUD, want to leave in in case steam has the same issue
local M28OldUnit = SConstructionUnit
if M28OldUnit then
    SConstructionUnit = Class(M28OldUnit) {
        OnStartBuild = function(self, built, order, ...)
            ForkThread(M28Events.OnConstructionStarted, self, built, order)
            if M28OldUnit.OnStartBuild then return M28OldUnit.OnStartBuild(self, built, order, unpack(arg)) end
        end,
        OnStopBuild = function(self, unit)
            if unit and not(unit.Dead) and unit.GetFractionComplete and unit:GetFractionComplete() == 1 then
                ForkThread(M28Events.OnConstructed, self, unit)
            end
            if M28OldUnit.OnStopBuild then return M28OldUnit.OnStopBuild(self, unit) end
        end,
        OnCreate = function(self)
            M28OldUnit.OnCreate(self)
            if M28OldUnit.OnCreate then ForkThread(M28Events.OnCreate, self) end
        end,

    }
end